C51 COMPILER V9.00   TIMER                                                                 05/21/2015 14:38:30 PAGE 1   


C51 COMPILER V9.00, COMPILATION OF MODULE TIMER
OBJECT MODULE PLACED IN timer.obj
COMPILER INVOKED BY: g:\Keil\C51\BIN\C51.EXE Source\timer.c INCDIR(..\电机控制) PRINT(.\timer.lst) OBJECT(timer.obj)

line level    source

   1            /*
   2          版权声明：
   3          WIFI机器人网・机器人创意工作室版权所有 www.wifi-robots.com
   4          您可以任意修改本程序，并应用于自行研发的智能小车机器人及其他电子产品上，但是禁止用于商业牟利。
   5          By WIFI机器人网・机器人创意工作室
   6          */
   7          #include "stc_new_8051.h"
   8          #include "timer.h"
   9          #include "steer.h"
  10          #include "IR.h"
  11          #include "Soft_uart.h"
  12          
  13          //uint8 rec_flag;
  14          //uint8 rec_flag;
  15          //uint16 Sampling_cnt;
  16          //bit IR_38K_En;
  17          //bit IR_R_T;
  18          //bit IR_EN;
  19          void Steering_Engine_Control(void);
  20          uint16 se_timer[8]={SE1_Deg,SE2_Deg,SE3_Deg,SE4_Deg,SE5_Deg,SE6_Deg,SE7_Deg,SE8_Deg};
  21          /* ms 延时 */
  22          void Delay_Ms(uint32 t)
  23          {  
  24   1          uint16 i;
  25   1              while(t--)
  26   1              {
  27   2                 for(i=0;i<1050;i++);
  28   2              }
  29   1      }
  30          /**/
  31          void Timer0_Init(void)
  32          {
  33   1          TMOD   &=   0xf0; 
  34   1          TMOD   |=   0x01; 
  35   1          AUXR   |=   0XC0;
  36   1          IP   |=   0x02;//定时器0中断优先级最高
  37   1          TR0=1;
  38   1          ET0=1;
  39   1      }
  40          
  41          
  42          void Timer1_Init(void)
  43          {
  44   1      //  TMOD   &=   0x0f;
  45   1      //  TMOD   |=   0x10;
  46   1      //  AUXR |= 0X40;
  47   1      //  IP |= 0x08; //定时器0中断优先级最高
  48   1      //  TR1=1;
  49   1      //  ET1=1;
  50   1          
  51   1          ET1     =     1;
  52   1          TMOD   &=   0x0f;
  53   1          TMOD   |=   0x10;
  54   1          TH1     =   0xA9;   //1MS定时
  55   1          TL1     =   0x9A;
C51 COMPILER V9.00   TIMER                                                                 05/21/2015 14:38:30 PAGE 2   

  56   1          TR1     =   1;    //开定时器1
  57   1      
  58   1      }
  59          /**/
  60          //void Timer_0(void) interrupt 1
  61          //{
  62          //    if(IR_EN ==1)
  63          //    {
  64          //        Timer_For_IR();
  65          //    }
  66          //    else
  67          //    {
  68          //        Steering_Engine_Control();
  69          //    }
  70          //}
  71          
  72          
  73          void Timer_1(void) interrupt 3
  74          {
  75   1      //   static uint16 ms_count=0;
  76   1      
  77   1      //  if(IR_EN == 1)
  78   1      //  {
  79   1      //      Timer_For_IR();
  80   1      //  }
  81   1      //  else
  82   1      //  {
  83   1      //      Steering_Engine_Control();
  84   1      //  }
  85   1      //
  86   1          
  87   1          static uint16 ms_count = 0;
  88   1          TH1     =   0xA9;
  89   1          TL1     =   0x9A;
  90   1      
  91   1          if(ms_count++ >= 1000)
  92   1          {
  93   2               ms_count = 0;
  94   2               if(rec_flag)
  95   2               {
  96   3                   LED5 = ~LED5;
  97   3               }
  98   2               else
  99   2               {
 100   3                   LED5 = 1;
 101   3               }
 102   2          }
 103   1              
 104   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    132    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =     18       4
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
